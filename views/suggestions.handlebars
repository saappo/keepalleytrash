<div class="d-flex justify-content-between align-items-center mb-4">
    <h2>
        <i class="fas fa-lightbulb text-success me-2"></i>Community Suggestions
    </h2>
    {{#if user}}
        <a href="/submit_suggestion" class="btn btn-success">
            <i class="fas fa-plus me-2"></i>New Suggestion
        </a>
    {{/if}}
</div>

<!-- Council Member Contact Section -->
<div class="card mb-4 border-primary">
    <div class="card-header bg-primary text-white">
        <h4 class="mb-0">
            <i class="fas fa-envelope me-2"></i>Email Templates to Your Council Member
        </h4>
    </div>
    <div class="card-body">
        <div class="alert alert-info">
            <h6><i class="fas fa-info-circle me-2"></i>Important Action Required</h6>
            <p class="mb-0">
                The City of Dallas is moving forward with alley collection changes. Contact your council member today to voice your concerns. 
                Use the email templates below to make your voice heard.
            </p>
        </div>

        <!-- Dallas City Council Members -->
        <h5 class="text-primary mb-3">Dallas City Council Members</h5>
        <div class="row mb-4">
            <div class="col-md-6 mb-3">
                <div class="card border-secondary">
                    <div class="card-body">
                        <h6 class="card-title">District 1 - Chad West</h6>
                        <p class="mb-1"><strong>Email:</strong> <a href="mailto:chad.west@dallascityhall.com">chad.west@dallascityhall.com</a></p>
                        <p class="mb-1"><strong>Phone:</strong> (214) 670-0771</p>
                        <button class="btn btn-sm btn-outline-primary mt-2" onclick="copyEmailTemplate('chad.west@dallascityhall.com')">
                            <i class="fas fa-copy me-1"></i>Copy Email Template
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="card border-secondary">
                    <div class="card-body">
                        <h6 class="card-title">District 2 - Jesse Moreno</h6>
                        <p class="mb-1"><strong>Email:</strong> <a href="mailto:jesse.moreno@dallascityhall.com">jesse.moreno@dallascityhall.com</a></p>
                        <p class="mb-1"><strong>Phone:</strong> (214) 670-0772</p>
                        <button class="btn btn-sm btn-outline-primary mt-2" onclick="copyEmailTemplate('jesse.moreno@dallascityhall.com')">
                            <i class="fas fa-copy me-1"></i>Copy Email Template
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="card border-secondary">
                    <div class="card-body">
                        <h6 class="card-title">District 3 - Zarin Gracey</h6>
                        <p class="mb-1"><strong>Email:</strong> <a href="mailto:zarin.gracey@dallascityhall.com">zarin.gracey@dallascityhall.com</a></p>
                        <p class="mb-1"><strong>Phone:</strong> (214) 670-0773</p>
                        <button class="btn btn-sm btn-outline-primary mt-2" onclick="copyEmailTemplate('zarin.gracey@dallascityhall.com')">
                            <i class="fas fa-copy me-1"></i>Copy Email Template
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="card border-secondary">
                    <div class="card-body">
                        <h6 class="card-title">District 4 - Carolyn King Arnold</h6>
                        <p class="mb-1"><strong>Email:</strong> <a href="mailto:carolyn.kingarnold@dallascityhall.com">carolyn.kingarnold@dallascityhall.com</a></p>
                        <p class="mb-1"><strong>Phone:</strong> (214) 670-0774</p>
                        <button class="btn btn-sm btn-outline-primary mt-2" onclick="copyEmailTemplate('carolyn.kingarnold@dallascityhall.com')">
                            <i class="fas fa-copy me-1"></i>Copy Email Template
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="card border-secondary">
                    <div class="card-body">
                        <h6 class="card-title">District 5 - Jaime Resendez</h6>
                        <p class="mb-1"><strong>Email:</strong> <a href="mailto:jaime.resendez@dallascityhall.com">jaime.resendez@dallascityhall.com</a></p>
                        <p class="mb-1"><strong>Phone:</strong> (214) 670-0775</p>
                        <button class="btn btn-sm btn-outline-primary mt-2" onclick="copyEmailTemplate('jaime.resendez@dallascityhall.com')">
                            <i class="fas fa-copy me-1"></i>Copy Email Template
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="card border-secondary">
                    <div class="card-body">
                        <h6 class="card-title">District 6 - Omar Narvaez</h6>
                        <p class="mb-1"><strong>Email:</strong> <a href="mailto:omar.narvaez@dallascityhall.com">omar.narvaez@dallascityhall.com</a></p>
                        <p class="mb-1"><strong>Phone:</strong> (214) 670-0776</p>
                        <button class="btn btn-sm btn-outline-primary mt-2" onclick="copyEmailTemplate('omar.narvaez@dallascityhall.com')">
                            <i class="fas fa-copy me-1"></i>Copy Email Template
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="card border-secondary">
                    <div class="card-body">
                        <h6 class="card-title">District 7 - Adam Bazaldua</h6>
                        <p class="mb-1"><strong>Email:</strong> <a href="mailto:adam.bazaldua@dallascityhall.com">adam.bazaldua@dallascityhall.com</a></p>
                        <p class="mb-1"><strong>Phone:</strong> (214) 670-0777</p>
                        <button class="btn btn-sm btn-outline-primary mt-2" onclick="copyEmailTemplate('adam.bazaldua@dallascityhall.com')">
                            <i class="fas fa-copy me-1"></i>Copy Email Template
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="card border-secondary">
                    <div class="card-body">
                        <h6 class="card-title">District 8 - Tennell Atkins</h6>
                        <p class="mb-1"><strong>Email:</strong> <a href="mailto:tennell.atkins@dallascityhall.com">tennell.atkins@dallascityhall.com</a></p>
                        <p class="mb-1"><strong>Phone:</strong> (214) 670-0778</p>
                        <button class="btn btn-sm btn-outline-primary mt-2" onclick="copyEmailTemplate('tennell.atkins@dallascityhall.com')">
                            <i class="fas fa-copy me-1"></i>Copy Email Template
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="card border-secondary">
                    <div class="card-body">
                        <h6 class="card-title">District 9 - Paula Blackmon</h6>
                        <p class="mb-1"><strong>Email:</strong> <a href="mailto:paula.blackmon@dallascityhall.com">paula.blackmon@dallascityhall.com</a></p>
                        <p class="mb-1"><strong>Phone:</strong> (214) 670-0779</p>
                        <button class="btn btn-sm btn-outline-primary mt-2" onclick="copyEmailTemplate('paula.blackmon@dallascityhall.com')">
                            <i class="fas fa-copy me-1"></i>Copy Email Template
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="card border-secondary">
                    <div class="card-body">
                        <h6 class="card-title">District 10 - Kathy Stewart</h6>
                        <p class="mb-1"><strong>Email:</strong> <a href="mailto:kathy.stewart@dallascityhall.com">kathy.stewart@dallascityhall.com</a></p>
                        <p class="mb-1"><strong>Phone:</strong> (214) 670-0780</p>
                        <button class="btn btn-sm btn-outline-primary mt-2" onclick="copyEmailTemplate('kathy.stewart@dallascityhall.com')">
                            <i class="fas fa-copy me-1"></i>Copy Email Template
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="card border-secondary">
                    <div class="card-body">
                        <h6 class="card-title">District 11 - Jaynie Schultz</h6>
                        <p class="mb-1"><strong>Email:</strong> <a href="mailto:jaynie.schultz@dallascityhall.com">jaynie.schultz@dallascityhall.com</a></p>
                        <p class="mb-1"><strong>Phone:</strong> (214) 670-0781</p>
                        <button class="btn btn-sm btn-outline-primary mt-2" onclick="copyEmailTemplate('jaynie.schultz@dallascityhall.com')">
                            <i class="fas fa-copy me-1"></i>Copy Email Template
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="card border-secondary">
                    <div class="card-body">
                        <h6 class="card-title">District 12 - Cara Mendelsohn</h6>
                        <p class="mb-1"><strong>Email:</strong> <a href="mailto:cara.mendelsohn@dallascityhall.com">cara.mendelsohn@dallascityhall.com</a></p>
                        <p class="mb-1"><strong>Phone:</strong> (214) 670-0782</p>
                        <button class="btn btn-sm btn-outline-primary mt-2" onclick="copyEmailTemplate('cara.mendelsohn@dallascityhall.com')">
                            <i class="fas fa-copy me-1"></i>Copy Email Template
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="card border-secondary">
                    <div class="card-body">
                        <h6 class="card-title">District 13 - Gay Donnell Willis</h6>
                        <p class="mb-1"><strong>Email:</strong> <a href="mailto:gay.donnellwillis@dallascityhall.com">gay.donnellwillis@dallascityhall.com</a></p>
                        <p class="mb-1"><strong>Phone:</strong> (214) 670-0783</p>
                        <button class="btn btn-sm btn-outline-primary mt-2" onclick="copyEmailTemplate('gay.donnellwillis@dallascityhall.com')">
                            <i class="fas fa-copy me-1"></i>Copy Email Template
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="card border-secondary">
                    <div class="card-body">
                        <h6 class="card-title">District 14 - Paul Ridley</h6>
                        <p class="mb-1"><strong>Email:</strong> <a href="mailto:paul.ridley@dallascityhall.com">paul.ridley@dallascityhall.com</a></p>
                        <p class="mb-1"><strong>Phone:</strong> (214) 670-0784</p>
                        <button class="btn btn-sm btn-outline-primary mt-2" onclick="copyEmailTemplate('paul.ridley@dallascityhall.com')">
                            <i class="fas fa-copy me-1"></i>Copy Email Template
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Email Template -->
        <div class="card border-success">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0">
                    <i class="fas fa-envelope-open-text me-2"></i>Email Template
                </h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <label for="emailTemplate" class="form-label">Copy this template and customize it for your council member:</label>
                    <textarea class="form-control" id="emailTemplate" rows="12" readonly>Subject: Urgent: Opposition to Alley Collection Changes

Dear Council Member [NAME],

I am writing to express my strong opposition to the City of Dallas's proposed changes to alley trash collection services. As a resident of [YOUR DISTRICT], I am deeply concerned about the impact these changes will have on our neighborhood and community.

Key Concerns:
• The transition from alley to curbside collection will negatively impact neighborhood aesthetics and property values
• Many residents, especially elderly and disabled individuals, will face significant challenges with curbside collection
• Our neighborhood was specifically designed for alley collection service
• The proposed changes will create safety hazards and reduce the walkability of our community

I urge you to:
1. Oppose the elimination of alley collection services
2. Support maintaining the current alley collection system
3. Consider alternative solutions that preserve neighborhood character while addressing operational concerns

Please represent the interests of your constituents and oppose these changes that will harm our community's quality of life.

Thank you for your attention to this urgent matter.

Sincerely,
[YOUR NAME]
[YOUR ADDRESS]
[YOUR PHONE NUMBER]</textarea>
                </div>
                <button class="btn btn-success" onclick="copyEmailTemplate()">
                    <i class="fas fa-copy me-2"></i>Copy Email Template
                </button>
            </div>
        </div>
    </div>
</div>

<!-- JavaScript for copying email template -->
<script>
function copyEmailTemplate(councilEmail = '') {
    const template = document.getElementById('emailTemplate').value;
    const emailToCopy = councilEmail ? 
        `To: ${councilEmail}\n\n${template}` : 
        template;
    
    navigator.clipboard.writeText(emailToCopy).then(function() {
        // Show success message
        const button = event.target || event.currentTarget;
        const originalText = button.innerHTML;
        button.innerHTML = '<i class="fas fa-check me-1"></i>Copied!';
        button.classList.remove('btn-outline-primary', 'btn-success');
        button.classList.add('btn-success');
        
        setTimeout(function() {
            button.innerHTML = originalText;
            button.classList.remove('btn-success');
            if (button.classList.contains('btn-sm')) {
                button.classList.add('btn-outline-primary');
            } else {
                button.classList.add('btn-success');
            }
        }, 2000);
    }).catch(function(err) {
        console.error('Could not copy text: ', err);
        // Fallback for older browsers
        const textArea = document.createElement('textarea');
        textArea.value = emailToCopy;
        document.body.appendChild(textArea);
        textArea.select();
        try {
            document.execCommand('copy');
            alert('Email template copied to clipboard!');
        } catch (err) {
            alert('Please manually copy the email template from the text box above.');
        }
        document.body.removeChild(textArea);
    });
}
</script>

{{#if suggestions}}
    <div class="row">
        {{#each suggestions}}
            <div class="col-12 mb-4">
                <div class="card shadow-sm">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start mb-2">
                            <h5 class="card-title mb-0">{{title}}</h5>
                            <div>
                                <span class="badge bg-{{#if (eq category 'cleanup')}}success{{else if (eq category 'safety')}}danger{{else if (eq category 'community')}}info{{else}}secondary{{/if}} me-2">
                                    {{category}}
                                </span>
                                <span class="badge bg-{{#if (eq status 'pending')}}warning{{else if (eq status 'approved')}}success{{else if (eq status 'rejected')}}danger{{else}}secondary{{/if}}">
                                    {{status}}
                                </span>
                            </div>
                        </div>
                        <p class="card-text">{{description}}</p>
                        <div class="d-flex justify-content-between align-items-center">
                            <small class="text-muted">
                                <i class="fas fa-user me-1"></i>{{username}} • 
                                <i class="fas fa-clock me-1"></i>{{formatDate created_at}}
                            </small>
                            {{#if (eq username ../user.username)}}
                                <small class="text-muted">
                                    <i class="fas fa-user-check me-1"></i>Your suggestion
                                </small>
                            {{/if}}
                        </div>
                    </div>
                </div>
            </div>
        {{/each}}
    </div>
{{else}}
    <div class="text-center py-5">
        <i class="fas fa-lightbulb fa-3x text-muted mb-3"></i>
        <h4 class="text-muted">No suggestions yet</h4>
        <p class="text-muted">Be the first to share your ideas for improving the community!</p>
        {{#if user}}
            <a href="/submit_suggestion" class="btn btn-success">
                <i class="fas fa-plus me-2"></i>Submit First Suggestion
            </a>
        {{else}}
            <a href="/login" class="btn btn-success">
                <i class="fas fa-sign-in-alt me-2"></i>Login to Suggest
            </a>
        {{/if}}
    </div>
{{/if}} 